function loadingStart(){loading=!0;$(".ui.main.container").css("display","none");$(".ui.dimmer").addClass("active")}function loadingStop(){loading=!1;$(".ui.sidebar.right").hasClass("visible")?$(".ui.main.container").css("cssText","margin-left: 260px !important"):$(".ui.main.container").removeAttr("style");$(".ui.dimmer").removeClass("active");addActionsToMessages();printLog("Loader stops")}function addActionsToMessages(){$(".ts-message").not(":has(> .action_hover_container), #message_edit_container").each(function(){return $(this).find(".message_sender").text()!==globalUserName||$(this).find(".member_image").data("member-id")!==globalUserId?!0:($(this).prepend('<div class="action_hover_container stretch_btn_heights narrow_buttons" data-js="action_hover_container" data-show_rxn_action="true">            <button type="button" data-action="edit" class="btn_unstyle btn_msg_action ts_tip" data-content="Edit message" data-position="bottom center">            <i class="edit icon"><\/i>            <\/button>            <button type="button" data-action="delete" class="btn_unstyle btn_msg_action ts_tip danger" data-content="Delete message" data-position="bottom right">            <i class="delete icon"><\/i>            <\/button>            <\/div>'),!0)})}function changeRoom(n){var t,i;(t=n.data("id"))&&currentRoomId!==t&&(loadingStart(),$("#chat_messages").empty(),myHub.server.leaveRoom(currentRoomId),$(".menu > a.item.active").removeClass("active"),i=myHub.server.joinRoom(t),$.when(i).then(function(){currentRoomId=t;n.data("name")&&!$("#channelsMenu").find("a:contains("+n.data("name")+")").length?(printLog("Add channel to sidebar from changeRoom()"),addRoomToSidebar(n.data("name"),t,n.data("ispublic")),n=$("#channelsMenu").find("a[data-id='"+t+"']")):n.is("div")&&(n=$("#channelsMenu").find("a[data-id='"+t+"']"));n.addClass("active");$("#channel_title").html(n.html());var i=myHub.server.getRoomInformation(currentRoomId);$.when(i).then(function(){loadingStop()})}))}function addEditContainer(n,t,i){return'<div class="ts-message message highlight" id="message_edit_container">            <div class="message_gutter">                <div class="message_icon">                    '+i+'                <\/div>            <\/div>            <form id="message_edit_form" data-id="'+n+'">                <button class="btn_unstyle emo_menu" aria-label="Emoji menu" type="button">                    <i class="meh icon"><\/i>                <\/button>                <div id="msg_text" class="message_input ql-container focus">                    <div class="ql-editor" role="textbox" tabindex="0" aria-multiline="true" aria-haspopup="true" spellcheck="true" contenteditable="true"><p>'+t+'<\/p><\/div>                    <div class="ql-clipboard" tabindex="-1" aria-hidden="true" role="presentation" spellcheck="true" contenteditable="true"><\/div>                <\/div>                <a id="cancel_edit" role="button" class="ui button mini">Cancel<\/a>                <a id="commit_edit" role="button" class="ui button mini positive"><i class="icon edit"><\/i>Save Changes<\/a>                <span id="message_editing_info" class="mini" style="display: none;">Finish editing this message first! Or press <strong>escape<\/strong> if youve changed your mind.<\/span>            <\/form>        <\/div>'}function emoReplacer(){for(var t=Array.prototype.slice.call(arguments),n=1;n<t.length-2;n++)if(t[n])return'<span class="emoji-outer emoji-sizer" style="background: url(/images/emoticons/'+emoticonsGroup[n]+'.png)" title="'+emoticonsGroup[n]+'">:'+emoticonsGroup[n]+":<\/span>"}function parseEmoticons(n){var t=new RegExp(emoticonRegex,"gi");return n.replace(t,emoReplacer)}function getMessageHtml(n,t,i,r,u,f){return'<div class="ts-message target" data-id="'+i+'"><div class="message_gutter"><div class="message_icon"><a href="/team/malgosia" target="/team/malgosia" class="member_image" data-member-id="'+t+'" style="background-image: url('+GravatarUrl+f+"?s=36&"+GravatarOptions+')" aria-hidden="true" tabindex="-1"> <\/a><\/div><\/div><div class="message_content"><div class="message_content_header"><a href="#" class="message_sender">'+n+'<\/a><a href="#" class="timestamp">'+u+'<\/a><\/div><span class="message_body">'+Autolinker.link(parseEmoticons(r))}function addRoomToSidebar(n,t,i){var r='<a class="item" data-id="'+t+'" data-ispublic="'+i+'">';r+=i?'<i class="icon left">#<\/i>':'<i class="lock icon left"><\/i>';r+=n+"<\/a>";$("#channelsMenu").append(r);updateChannelsCount(1)}function inviteUsers(){var n,t,i;loading||(n=$("#inviteUsersForm"),n[0].reset(),n.find(".invite-users-tag").remove(),t=myHub.server.getNotInvitedUsers(currentRoomId),i=$(".ui.basic.invite-users.modal"),$.when(t).then(function(){$(i).modal({closable:!1,onShow:function(){$(".ui.dimmer.modals").css("background-color","#fff")},onHide:function(){$(".ui.dimmer.modals").css("background-color","")}}).modal("show")}))}function searchPrivateModal(n){var t=$(".private-conversation-row[data-is-selected='false']");modalListSearch(n,t)}function searchInviteModal(n){var t=$(".invite-users-row[data-is-selected='false']");modalListSearch(n,t)}function modalListSearch(n,t){if(!n.length){t.show();return}var i=new RegExp(n,"i");t.each(function(){var n=i.test($(this).data("name"));$(this).toggle(n)})}function updateChannelsCount(n){var i=$("#channelsCount"),t=i.text().match(/\d+/);t=parseInt(t)+n;i.text("CHANNELS ("+t+")")}function serializeForm(n){var i=$(n).serializeArray(),t={};return $.each(i,function(n,i){t[i.name]=i.value}),t}function channelSettings(){var n=$("#Rightbar"),t,i,r;n.html("");$("#rightbar_Title").html("Channel Settings");t='<div class="item">                            <div class="ui styled accordion">                                    <div class="accordion">                                        <div class="title"><i class="theme icon"><\/i>Customization<\/div>                                        <div class="content" id="customization">                                            <div class="ui form">                                                <div class="field">                                                    <select id="selecttheme" class="ui dropdown" onchange="selectTheme(this);">                                                        <option value="0">Black<\/option>                                                        <option value="1">Blue<\/option>                                                        <option value="2">Green<\/option>                                                        <option value="3">Orange<\/option>                                                        <option value="4">Pink<\/option>                                                    <\/select>                                                <\/div>                                            <\/div>                                        <\/div>                                        <div class="title"><i class="wpforms icon"><\/i>Topic<\/div>                                        <div class="content" id="Topic">                                            <div class="ui form">                                                <div class="field">                                                <input type="text" id="infoTopic">                                                <\/div>                                            <\/div>                                        <\/div>                                        <div class="title"><i class="wpforms icon"><\/i>Description<\/div>                                        <div class="content" id="roomDescription">                                            <div class="ui form">                                                <div class="field">                                                <input type="text" id="infoDescription">                                                <\/div>                                            <\/div>                                        <\/div>                                        <div class="title"><i class="wpforms icon"><\/i>Room Name<\/div>                                        <div class="content" id="roomName">                                            <div class="ui form">                                                <div class="field">                                                <input type="text" id="infoName">                                                <\/div>                                            <\/div>                                        <\/div>                                        <div class="title"><i class="delete icon"><\/i>Delete Room<\/div>                                        <div class="content" id="deleteRoom">                                            <div class="ui two column centered grid">                                                    <div class="ui form ">                                                        <div class="field">                                                            <button class="negative ui button" id="deleteRoomButton" data-tooltip="Irrevocable removal of the room" data-position="bottom center" onclick="deleteRoom();">Delete Room<\/button>                                                        <\/div>                                                    <\/div>                                                <\/div>                                         <\/div>                                    <\/div>                            <\/div>                        <\/div>';i='<div class="bottom attached centered ui item" id="right_bar_save_cancel_buttons">                            <div class="ui buttons" tabindex="0"><button class="ui button" onclick="closeRightBarCallback();">Cancel<\/button>                                <div class="or"><\/div>                                <button class="ui positive button" onclick="changeSettingsValue(currentTheme);">Save<\/button>                            <\/div>                        <\/div>';n.append(t);r=myHub.server.getRoomInformation(currentRoomId);$.when(r).then(function(){$("#rightsidebarblock").append(i);$(".ui.styled.accordion").accordion()})}function channelDetails(){var n=$("#Rightbar"),t;n.html("");$("#right_bar_save_cancel_buttons").length&&$("#right_bar_save_cancel_buttons").remove();$("#rightbar_Title").html("Channel Details");n.append('<div class="ui styled accordion"><div class="active content"><div class="accordion"><div class="title"><i class="dropdown icon"><\/i><i class="info icon"><\/i>About<\/div><div class="content" id="aboutInfo"><\/div><div class="title"><i class="dropdown icon"><\/i><i class="users icon"><\/i>Members<\/div><div class="content" id="MembersInRoom"><\/div><\/div><\/div><\/div>');myHub.server.getRoomUsers(currentRoomId);t=myHub.server.getRoomInformation(currentRoomId);$.when(t).then(function(){$(".ui.styled.accordion").accordion()})}function changeSettingsValue(n){var u=parseInt(currentTheme),t=$("#infoTopic").val(),i=$("#infoName").val(),r=$("#infoDescription").val();roomNameInDatabase!==i&&myHub.server.editRoomName(currentRoomId,i);topicInDatabase!==t&&myHub.server.editRoomTopic(currentRoomId,t);descriptionInDatabase!==r&&myHub.server.editRoomDescription(currentRoomId,r);themeInDatabase!==n&&myHub.server.editRoomCustomization(currentRoomId,u);$(".ui.sidebar.right").removeClass("visible");$(".ui.main.container").removeAttr("style")}function changeTheme(n){var t;switch(n){case"0":t="#1B1C1D";break;case"1":t="#0080ff";break;case"2":t="#33CC00";break;case"3":t="#FF9900";break;case"4":t="#D15CC1";break;default:t="#1B1C1D"}$(".ui.sidebar.left").css("background-color",t)}function selectTheme(n){currentTheme=n.value;changeTheme(currentTheme)}function changeChannelSettingsPopup(n){$("#channel_settings_toggle").attr({"data-content":n+" Channel Settings","aria-label":n+" Channel Settings"})}function changeChannelDetailsPopup(n){$("#channel_details_toggle").attr({"data-content":n+" Channel Details","aria-label":n+" Channel Details"})}var myHub,additionalEmoticonNames,emoticonRegex,emoticonsGroup,i,j,loadingMessageOffset,closeRightBarCallback;$(".ui.sidebar.left, .ui.sidebar.right").sidebar();$("#directMessagesTitle, #channelsCount, #closerightbar, #deleteRoomButton").popup({variation:"inverted"});$(document).on("reloadPopups",function(){$(".ts_tip").popup({variation:"inverted"});$(".item > .btn_unstyle.right").popup({variation:"inverted"})});var Autolinker=new Autolinker({stripPrefix:!1,stripTrailingSlash:!1,phone:!1}),globalDomainName,globalUserName,globalUserId,loading=!0,currentTheme,topicInDatabase,roomNameInDatabase,descriptionInDatabase,themeInDatabase,currentRoomId=0,isCurrentRoomPrivateConversation,clippyShow=!1,GravatarUrl="https://www.gravatar.com/avatar/",GravatarOptions="d=retro";$(window).resize(function(){var n=117,t=$(".ui.message"),i;t.length&&(t.hasClass("hidden")||(n+=51));$("#chat_messages").height($(window).height()-n);i=165;$(".sidebar_channels_messages").height($(window).height()-i)});$(window).trigger("resize");$.connection.hub.url="http://localhost:52284/signalr";myHub=$.connection.channelHub;$("#channelsCount").click(function(){if(!loading){$("#browseChannelsForm")[0].reset();var n=myHub.server.getDomainPublicAndUserRooms(),t=$(".ui.basic.browse-channels.modal");$.when(n).then(function(){$(t).modal({closable:!1,onShow:function(){$(".ui.dimmer.modals").css("background-color","#fff")},onHide:function(){$(".ui.dimmer.modals").css("background-color","")}}).modal("show")})}});$(".menu").on("click",".menu > a.item",function(n){loading||changeRoom($(n.currentTarget))});$("#chat_messages").on("click",".ts-message .btn_msg_action[data-action='edit']",function(n){function i(n){$(document).find("#message_edit_container").length&&($(n.target).parents().addBack().is("#message_edit_container")||(document.removeEventListener("click",i,!0),$(document).find("#message_edit_container").prev().show(),$(document).find("#message_edit_container").remove()))}var e,r,o;$(document).find("#message_edit_container").length&&($(document).find("#message_edit_container").prev().show(),$(document).find("#message_edit_container").remove());var t=$(n.target).closest(".ts-message"),u=t.data("id"),f=t.find(".message_body").text();t.hide();t.after(addEditContainer(u,f,t.find(".message_icon").html()));e=$(".ql-editor");e.focus();r=document.createRange();r.selectNodeContents(e.get(0));r.collapse(!1);o=window.getSelection();o.removeAllRanges();o.addRange(r);$(document).find("#message_edit_container").length&&document.addEventListener("click",i,!0);$(".ts-message").on("click","#cancel_edit",function(n){document.removeEventListener("click",i,!0);t.show();$(n.target).closest("#message_edit_container").remove()});$("#message_edit_container").keydown(function(n){n.keyCode===27&&(document.removeEventListener("click",i,!0),$(document).find("#message_edit_container").prev().show(),$(document).find("#message_edit_container").remove())});$("#message_edit_form").keypress(function(n){if(n.which===13&&!n.shiftKey){var r=$(".ql-editor").text().trim();f!==r&&r&&myHub.server.editMessage(currentRoomId,u,r);document.removeEventListener("click",i,!0);t.show();$(n.target).closest("#message_edit_container").remove()}});$(".ts-message").on("click","#commit_edit",function(n){var r=$(".ql-editor").text().trim();f!==r&&r&&myHub.server.editMessage(currentRoomId,u,r);document.removeEventListener("click",i,!0);t.show();$(n.target).closest("#message_edit_container").remove()})});$(".grid").on("click",".private-conversation-row",function(n){var t=n.currentTarget,r=$(t).data("name"),u=$(t).data("id"),i=$("#private_inputtext");$(t).attr("data-is-selected","true");$(t).hide();$(i).attr("placeholder","");$("#createPrivateConversationForm").find(":submit").removeClass("disabled").addClass("positive");$(i).before('<span class="private-conversation-tag" data-id="'+u+'">'+r+' <i class="remove icon"><\/i><\/span>')});$(".grid").on("click",".invite-users-row",function(n){var t=n.currentTarget,r=$(t).data("name"),u=$(t).data("id"),i=$("#invite_inputtext");$(t).attr("data-is-selected","true");$(t).hide();$(i).attr("placeholder","");$("#inviteUsersForm").find(":submit").removeClass("disabled").addClass("positive");$(i).before('<span class="invite-users-tag" data-id="'+u+'">'+r+' <i class="remove icon"><\/i><\/span>')});$("#chat_messages").on("click",".ts-message .btn_msg_action[data-action='delete']",function(n){$(".ui.delete.modal").modal({onApprove:function(){var t=$(n.target).closest(".ts-message").data("id");myHub.server.deleteMessage(currentRoomId,t)}}).modal("show")});for(myHub.client.broadcastEditedMessage=function(n,t){var f=$(".ts-message[data-id='"+n+"']"),i=f.find(".message_body"),r,u;i.first().html(Autolinker.link(parseEmoticons(t)));r=t.match(/watch\?v=([a-zA-Z0-9\-_]+)/);r?(u='<iframe src="https://www.youtube.com/embed/'+r[1]+'?feature=oembed&amp;autoplay=0&amp;iv_load_policy=3" allowfullscreen="" height="300" frameborder="0" width="400"><\/iframe>',i.last().hasClass("youtube_iframe")?i.last().html(u):i.last().after(u)):i.last().hasClass("youtube_iframe")&&i.last().hide("slow",function(){i.last().remove()})},additionalEmoticonNames=["poop","party"],emoticonRegex="(:smile:|\\B:-?[)]\\B)|(:smile_big:|\\B:-?[D]\\b)|(:sad:|\\B:-?[(]\\B)|(:tongue:|\\B:-?[P]\\b)|(:crying:|\\B;-?[(]\\B)|(:wink:|\\B;-?[)]\\B)",i=0;i<additionalEmoticonNames.length;i++)emoticonRegex+="|(:"+additionalEmoticonNames[i]+":)";for(emoticonsGroup={1:"smile",2:"smile_big",3:"sad",4:"tongue",5:"crying",6:"wink"},i=Object.keys(emoticonsGroup).length+1,j=0;j<additionalEmoticonNames.length;i++,j++)emoticonsGroup[i]=additionalEmoticonNames[j];loadingMessageOffset=!1;$("#chat_messages").scroll(function(){var t,n,i;$(".ui.dimmer").hasClass("active")||loadingMessageOffset||(t=$("#chat_messages").scrollTop(),t<100&&(loadingMessageOffset=!0,n=$("#chat_messages").children().first(),$(".ui.dimmer").addClass("active"),i=myHub.server.getPreviousMessages(currentRoomId,n.data("id")),$.when(i).then(function(){var i=n.prevAll(),t;i.length>0&&(t=0,i.each(function(){t+=$(this).outerHeight()}),$("#chat_messages").scrollTop(t));$(".ui.dimmer").removeClass("active");loadingMessageOffset=!1})))});myHub.client.broadcastMessage=function(n,t,i,r,u,f){var o=getMessageHtml(n,t,i,r,u,f),s=r.match(/watch\?v=([a-zA-Z0-9\-_]+)/),e;o+=s?'<\/span><span class="message_body youtube_iframe"><iframe src="https://www.youtube.com/embed/'+s[1]+'?feature=oembed&amp;autoplay=0&amp;iv_load_policy=3" allowfullscreen="" height="300" frameborder="0" width="400"><\/iframe><\/span><\/div><\/div>':"<\/span><\/div><\/div>";e=$("#chat_messages");e.append(o);e.clearQueue();e.animate({scrollTop:e[0].scrollHeight},"slow");addActionsToMessages();$(document).trigger("reloadPopups")};myHub.client.deleteMessage=function(n){var t=$(".ts-message[data-id='"+n+"']");t.hide("slow",function(){t.remove()})};myHub.client.loadRooms=function(n){var t=!0;$("#channelsCount").text("CHANNELS ("+n.length+")");$.each(n,function(n,i){var r='<a class="item';t&&(r+=" active",t=!1,currentRoomId=i.Id);r+='"data-id="'+i.Id+'" data-ispublic="'+i.IsPublic+'">';r+=i.IsPublic?'<i class="icon left">#<\/i>':'<i class="lock icon left"><\/i>';r+=i.Name+"<\/a>";$("#channelsMenu").append(r)})};myHub.client.loadDomainPublicAndUserRooms=function(n){$("#browseChannelsList").empty();$.each(n,function(n,t){var i='<div class="row browse-room-row" data-id="'+t.Id+'" data-name="'+t.Name+'" data-ispublic="'+t.IsPublic+'">';i+='<div class="eight wide column">';i+=t.IsPublic?"# ":'<i class="lock icon"><\/i> ';i+="<strong>"+t.Name+"<\/strong>";$("#channelsMenu").find("a:contains("+t.Name+")").length&&(i+="  <small>JOINED<\/small>");i+="<br><i>Created by <strong>"+t.Owner+"<\/strong> on "+t.CreatedOn+"<\/i>";i+="<br>"+t.Description+"<\/div>";i+='<div class="six wide column"><\/div>';i+='<div class="two wide column mycheckmark"><i class="level down rotated big blue icon"><\/i><\/div>';i+="<\/div>";$("#browseChannelsList").append(i)})};$(".grid").on("click",".browse-room-row",function(n){var t=$(n.currentTarget);changeRoom(t);$(".ui.basic.browse-channels.modal").modal("hide")});myHub.client.loadPrivateConversations=function(n){$.each(n,function(n,t){var i='<a class="item" data-id="'+t.Id+'"><i class="lock icon left"><\/i>'+t.Name+"<\/a>";$("#privateConversationsMenu").append(i)})};myHub.client.parseLastMessages=function(n){$.each(n,function(n,t){var i=getMessageHtml(t.UserName,t.UserId,t.Id,t.Text,t.CreatedOn,t.EmailHash),r=t.Text.match(/watch\?v=([a-zA-Z0-9\-_]+)/);i+=r?'<\/span><span class="message_body youtube_iframe"><iframe src="https://www.youtube.com/embed/'+r[1]+'?feature=oembed&amp;autoplay=0&amp;iv_load_policy=3" allowfullscreen="" height="300" frameborder="0" width="400"><\/iframe><\/span><\/div><\/div>':"<\/span><\/div><\/div>";$("#chat_messages").append(i)});var t=$("#chat_messages");$(".ui.main.container").css("display","block");t.clearQueue();t.animate({scrollTop:t[0].scrollHeight},"slow");addActionsToMessages();$(document).trigger("reloadPopups")};myHub.client.parseOffsetMessages=function(n){$.each(n,function(n,t){var i=getMessageHtml(t.UserName,t.UserId,t.Id,t.Text,t.CreatedOn,t.EmailHash),r=t.Text.match(/watch\?v=([a-zA-Z0-9\-_]+)/);i+=r?'<\/span><span class="message_body youtube_iframe"><iframe src="https://www.youtube.com/embed/'+r[1]+'?feature=oembed&amp;autoplay=0&amp;iv_load_policy=3" allowfullscreen="" height="300" frameborder="0" width="400"><\/iframe><\/span><\/div><\/div>':"<\/span><\/div><\/div>";$("#chat_messages").prepend(i)});addActionsToMessages();$(document).trigger("reloadPopups")};myHub.client.channelAddedAction=function(n,t,i){addRoomToSidebar(n,t,i);changeRoom($("#channelsMenu").children().last())};myHub.client.privateConversationAddedAction=function(n){var i='<a class="item" data-id="'+n.Id+'"><i class="lock icon left"><\/i>'+n.Name+"<\/a>",t=$("#privateConversationsMenu");t.append(i);changeRoom(t.children().last())};myHub.client.inviteUsersAddedAction=function(){printLog("inviteUsersAddedAction");loadingStop()};myHub.client.privateConversationsUsersLoadedAction=function(n){$("#privateConversationsUserList").empty();$.each(n,function(n,t){var i='<div class="row private-conversation-row" data-id="'+t.Id+'" data-name="'+t.Name+'" data-is-selected="false">';i+='<div class="eight wide column"><img class="gravatarMembersList" src="'+GravatarUrl+t.EmailHash+"?s=20&"+GravatarOptions+'" alt="avatar"><strong>'+t.Name+"<\/strong> ";i+=t.IsOnline?'<i class="circle icon green"><\/i>':'<i class="circle thin icon"><\/i>';i+="<\/div>";i+='<div class="six wide column"><\/div>';i+='<div class="two wide column mycheckmark"><i class="level down rotated big blue icon"><\/i><\/div>';i+="<\/div>";$("#privateConversationsUserList").append(i)})};myHub.client.notInvitedUsersLoadedAction=function(n){$("#inviteUsersList").empty();$.each(n,function(n,t){var i='<div class="row invite-users-row" data-id="'+t.Id+'" data-name="'+t.Name+'" data-is-selected="false">';i+='<div class="eight wide column"><img class="gravatarMembersList" src="'+GravatarUrl+t.EmailHash+"?s=20&"+GravatarOptions+'" alt="avatar"><strong>'+t.Name+"<\/strong> ";i+=t.IsOnline?'<i class="circle icon green"><\/i>':'<i class="circle thin icon"><\/i>';i+="<\/div>";i+='<div class="six wide column"><\/div>';i+='<div class="two wide column mycheckmark"><i class="level down rotated big blue icon"><\/i><\/div>';i+="<\/div>";$("#inviteUsersList").append(i)})};myHub.client.setDomainInformation=function(n,t,i){globalDomainName=n;globalUserName=t;globalUserId=i;$("#team_name").text(globalDomainName);$("#team_menu_user_name").text(globalUserName);document.title=globalDomainName+" "+document.title};myHub.client.updateRoomUsersCount=function(n){$("#channel_members_toggle_count_count").text(n)};$.connection.hub.start().done(function(){printLog("Connected to Hub. Connection ID: "+$.connection.hub.id+". Getting rooms");var n=myHub.server.getRooms(),t=myHub.server.getPrivateConversations();$.when(n&&t).then(function(){var t=($.now()-startTime)/1e3,n;printLog("Finished first boot "+t+" seconds after DOM ready");n=myHub.server.joinRoom(currentRoomId);$.when(n).then(function(){var n,t;printLog("Connected to room after boot");n=$(".menu > a.item.active");$("#channel_title").html($(n).html());t=myHub.server.getRoomInformation(currentRoomId);$.when(t).then(function(){loadingStop();$("#msg_form").keypress(function(n){if(n.which===13&&!n.shiftKey){var t=$("#msg_input").val().trim();t&&(t==="zerg"?(printLog("You Must Construct Additional Pylons!"),new ZergRush(100)):t==="clippy"?clippyShow?($(".clippy").hide("slow",function(){$(".clippy").remove();$(".clippy-balloon").remove()}),clippyShow=!1):(printLog("Best Word users friend"),clippyShow=!0,clippy.load("Clippy",function(n){n.show();n.play("Greeting");n.speak("Hi! Remember me?");setInterval(function(){n.animate()},2e4)})):myHub.server.sendMessage(currentRoomId,t));n.preventDefault();$("#msg_input").val("")}})})})})}).fail(function(n){printLog("Not connected! "+n)});$.connection.hub.error=function(n){console.error(n);printLog(n)};$.connection.hub.stateChanged(function(n){n.newState===$.signalR.connectionState.reconnecting&&(printLog("Re-connecting"),loadingStart())});$.connection.hub.reconnected(function(){printLog("Reconnected");loadingStop()});window.onbeforeunload=function(){$.connection.hub.stop()};$("#createNewChannel, #newChannel").click(function(){if(!loading){$("#createChanelForm")[0].reset();var n=$("input[name*='IsPublic']")[1],t=$(".ui.basic.create-room.modal");n.value=!1;$(t).modal({closable:!1,onShow:function(){$(".ui.dimmer.modals").css("background-color","#fff")},onHide:function(){$(".ui.dimmer.modals").css("background-color","")}}).modal("show")}});$("#createNewPrivateConversation, #directMessagesTitle").click(function(){var n,t,i;loading||(n=$("#createPrivateConversationForm"),n[0].reset(),n.find(".private-conversation-tag").remove(),t=myHub.server.getUsersFromDomain(),i=$(".ui.basic.create-private-conversation.modal"),$.when(t).then(function(){$(i).modal({closable:!1,onShow:function(){$(".ui.dimmer.modals").css("background-color","#fff")},onHide:function(){$(".ui.dimmer.modals").css("background-color","")}}).modal("show")}))});$("#private_inputtext").keyup(function(){searchPrivateModal($(this).val())});$("#invite_inputtext").keyup(function(){searchInviteModal($(this).val())});$("#findChannelName").keyup(function(){var n=$(this).val(),t=$(".browse-room-row");modalListSearch(n,t)});$("#myCheckBox").click(function(){$(this).is(":checked")?($("#createNewChannelHeader").html("Create a channel"),$("#createNewChannelLabel").html("Anyone on your team can view and join this channel"),$("input[name*='IsPublic']")[1].value=!0):($("#createNewChannelHeader").html("Create a private channel"),$("#createNewChannelLabel").html("This channel can only be joined by invite"),$("input[name*='IsPublic']")[1].value=!1)});$("#createChanelForm").submit(function(n){loadingStart();n.preventDefault();var t=serializeForm($(this));myHub.server.createNewChannel(t);$(".ui.basic.create-room.modal").modal("hide")});$("#createPrivateConversationForm").submit(function(n){printLog("Begin submit #createPrivateConversationForm");n.preventDefault();var i=[],t=[],f=$("#createPrivateConversationForm").find(".private-conversation-tag");if(f.each(function(n,r){i.push($(r).data("id"));t.push($.trim($(r).text()))}),i.length>0){var e=$("#privateConversationsMenu a"),r={},u=[];e.each(function(n,i){if(u=$(i).text().split(", "),u.length!==t.length)return!0;var f=0;return $(t).each(function(n,t){$(u).each(function(n,i){if(i===t)return f+=1,!1})}),f===t.length?(r=$(i),!1):void 0});r.length?(printLog("Change room"),changeRoom(r)):(printLog("Add new private conversation channel"),loadingStart(),myHub.server.createNewPrivateConversation(i));$(".ui.basic.create-private-conversation.modal").modal("hide")}});$("#inviteUsersForm").submit(function(n){printLog("Begin submit #inviteUsersForm");n.preventDefault();var t=[],i=$("#inviteUsersForm").find(".invite-users-tag");i.each(function(n,i){t.push($(i).data("id"))});loadingStart();printLog("Inviting new users");myHub.server.inviteUsersToPrivateRoom(currentRoomId,t);$(".ui.basic.invite-users.modal").modal("hide")});myHub.client.broadcastEditedRoomTopic=function(n){topicInDatabase=n;$("#channel_topic_text").html(n);$(".ui.sidebar.right").hasClass("visible")&&$("#rightbar_Title").text()==="Channel Settings"&&$("#infoTopic").val(topicInDatabase)};myHub.client.broadcastEditedRoomDescription=function(n){descriptionInDatabase=n;$(".ui.sidebar.right").hasClass("visible")&&($("#rightbar_Title").text()==="Channel Settings"?$("#infoDescription").val(descriptionInDatabase):$("#channelDetailsDescription").text(descriptionInDatabase))};myHub.client.broadcastEditedRoomCustomization=function(n){themeInDatabase=n.toString();changeTheme(themeInDatabase);$(".ui.sidebar.right").hasClass("visible")&&$("#rightbar_Title").text()==="Channel Settings"&&$("#selecttheme").val(n)};myHub.client.broadcastEditedActiveRoomName=function(n){roomNameInDatabase=n;$("#channel_title").contents().last().replaceWith(roomNameInDatabase);$("#channelsMenu").find("> a.item.active").contents().last().replaceWith(roomNameInDatabase);$("#msg_input").attr("placeholder","Message "+roomNameInDatabase);$(".ui.sidebar.right").hasClass("visible")&&$("#rightbar_Title").text()==="Channel Settings"&&$("#infoName").val(roomNameInDatabase)};myHub.client.broadcastDomainEditedRoomName=function(n,t){var i=$("#channelsMenu");i.find("> a.item.active").data("id")!==n&&i.find("a[data-id='"+n+"']").contents().last().replaceWith(t)};$("#channel_settings_toggle").click(function(){var n=$(".ui.sidebar.right");n.hasClass("visible")?$("#rightbar_Title").text()==="Channel Settings"?(changeChannelSettingsPopup("Show"),n.removeClass("visible"),$(".ui.main.container").removeAttr("style")):(channelSettings(),changeChannelSettingsPopup("Hide"),changeChannelDetailsPopup("Show")):(channelSettings(),changeChannelSettingsPopup("Hide"),n.addClass("visible"),$(".ui.main.container").css("cssText","margin-left: 260px !important"))});closeRightBarCallback=function(){$(".ui.sidebar.right").removeClass("visible");$(".ui.main.container").removeAttr("style");changeTheme(themeInDatabase)};$("#closerightbar").click(function(){closeRightBarCallback()});$(document).keydown(function(n){n.keyCode===27&&($(".ui.sidebar.right").hasClass("visible")&&closeRightBarCallback(),$(".ui.basic.modal").modal("hide"))});$("#channel_details_toggle, #channel_members_toggle_count").click(function(){var n=$(".ui.sidebar.right");n.hasClass("visible")?$("#rightbar_Title").html()==="Channel Details"?(changeChannelDetailsPopup("Show"),n.removeClass("visible"),$(".ui.main.container").removeAttr("style")):(channelDetails(),changeChannelDetailsPopup("Hide"),changeChannelSettingsPopup("Show")):(channelDetails(),changeChannelDetailsPopup("Hide"),n.addClass("visible"),$(".ui.main.container").css("cssText","margin-left: 260px !important"))});$(document).on("click",".private-conversation-tag",function(n){var u=$(n.currentTarget).data("id"),r=$('.row.private-conversation-row[data-id="'+u+'"]'),t,i;r.attr("data-is-selected","false");r.show();$(n.currentTarget).remove();t=$("#private_inputtext");i=$("#createPrivateConversationForm");searchPrivateModal(t.val());i.find(".private-conversation-tag").length||(i.find(":submit").addClass("disabled").removeClass("positive"),t.attr("placeholder","Find or start a conversation"))});$(document).on("click",".invite-users-tag",function(n){var u=$(n.currentTarget).data("id"),r=$('.row.invite-users-row[data-id="'+u+'"]'),t,i;r.attr("data-is-selected","false");r.show();$(n.currentTarget).remove();t=$("#invite_inputtext");i=$("#inviteUsersForm");searchInviteModal(t.val());i.find(".invite-users-tag").length||(i.find(":submit").addClass("disabled").removeClass("positive"),t.attr("placeholder","Search by name"))});myHub.client.usersInRoom=function(n){$("#MembersInRoom").empty();$("#MembersInRoom").prev().contents().last().replaceWith(n.length+" Members");$.each(n,function(n,t){var i='<div class="row MembersInRoom-row" data-id="'+t.Id+'" data-name="'+t.Name+'">';i+='<div class="eight wide column"><img class="gravatarMembersList" src="'+GravatarUrl+t.EmailHash+"?s=20&"+GravatarOptions+'" alt="avatar">'+t.Name;globalUserName===t.Name&&(i+="(you)");i+=t.IsOnline?'<i class="small circle icon green"><\/i>':'<i class="small circle thin icon"><\/i>';i+="<\/div><\/div>";$("#MembersInRoom").append(i)})};myHub.client.roomInfo=function(n,t){var u,f,i,r;themeInDatabase=String(n.Customization);currentTheme=themeInDatabase;topicInDatabase=n.Topic;roomNameInDatabase=n.Name;descriptionInDatabase=n.Description;isCurrentRoomPrivateConversation=n.IsPrivateConversation;changeTheme(themeInDatabase);$(".ui.sidebar.right").hasClass("visible")&&($("#rightbar_Title").html()==="Channel Details"?(u="<div>Created by <strong>"+n.OwnerName+"<\/strong> on "+t+'<h5>Description<\/h5><span id="channelDetailsDescription">'+n.Description+"<\/span><\/div>",$("#aboutInfo").empty().append(u),n.IsPublic||n.IsPrivateConversation?$("#inviteButtonContainer").remove():(f='<div class="ui two column centered grid" id="inviteButtonContainer">                    <button class="primary ui button" id="inviteButton" onclick="inviteUsers();">Invite users<\/button>                    <\/div>',$(".ui.styled.accordion").append(f))):($("#selecttheme").val(themeInDatabase),$("#infoTopic").val(n.Topic),$("#infoDescription").val(n.Description),isCurrentRoomPrivateConversation?$("#roomName").prev().fadeOut("fast",function(){$("#roomName").removeClass("active");$(this).removeClass("active")}):($("#infoName").val(roomNameInDatabase),$("#roomName").prev().fadeIn("fast",function(){$(this).show()}))));$("#channel_topic_text").html(topicInDatabase);isCurrentRoomPrivateConversation?(r=roomNameInDatabase.split(", "),i=roomNameInDatabase,$(r).each(function(n,t){if(t===globalUserName)return r.splice(n,1),i=r,!1})):i=roomNameInDatabase;$("#msg_input").attr("placeholder","Message "+i)};